1,2c1
< #!/Perl/5.00502/bin/MSWin32-x86-object/perl
< #!/apps/stage/depl/bin/perl
---
> #!/Perl/bin/perl
5c4
< use NetDepth ;
---
> use LocalDepth ;
9c8
< $ob = new NetDepth ;
---
> $ob = new LocalDepth ;
18c17
<  
---
> 
36a36,37
> &search                         if  $path_info =~ /^\/search$/          ;
> &search_depth                   if  $path_info =~ /^\/search_depth$/          ;
38,41c39
< &search                         if  $path_info =~ /^\/search$/       ;
< &search_depth                   if  $path_info =~ /^\/search_depth$/ ;
< &new_depth_ob                   if  $path_info =~ /^\/new$/ ;
< &mk_new_ob                      if  $path_info =~ /^\/mk_new_ob$/ ;
---
> &new_fz                         if  $path_info =~ /^\/new_fz$/          ;
57c55
<    <frameset cols="16,50">
---
>    <frameset cols="19,50">
66,70c64,67
<     
<     $arr = $ob -> db() ;
<     $arr = eval $arr ;
<     @$arr = sort @$arr ;
<     print "<H3> DataBases<\H3><HR>";
---
>     $arr = $ob -> db()                     ;
>     $arr = eval $arr                       ;
>     @$arr = sort @$arr                     ;
>     print "<H3> DataBases<\H3><HR>"        ;
78,105c75,77
<    print " ".$query->submit(-name => 'PICK DB') ;
<    &pr_hidden_struct;
<    print $query->endform;
<    &xit 
< }
< 
< sub pr_referer {   
<     $last_url = $script_name."/ctls" if $last_url eq ''         ;
<     print "<a href=\"$last_url\">
<     <IMG SRC=\"/images/left_arrow_ylo_gry.gif\" BORDER=\"0\"> 
<    </a>" if $last_url                                           ;
< }
< 
< sub pr_hidden_struct {
<     $hidden_struct_str = $ob -> dump($hidden_struct)            ; 
<     $query -> param('hidden_struct', $hidden_struct_str)        ;
<     $query -> param('hidden_last_url', $hidden_last_url)        ;
<     print $query -> hidden('hidden_struct')                     ;
<     print $query -> hidden('hidden_last_url')                   ;
< }
< 
< sub eval_hidden_struct {   
< 
<    $hidden_struct_str = $query -> param('hidden_struct')        ;
<    $hidden_struct     = eval $hidden_struct_str                 ;
<    $last_url          = $query -> param('hidden_last_url')      ;
<    $hidden_last_url = $query->url(-path_info=>1,-query=>1);
< 
---
>     print " ".$query->submit(-name => 'PICK DB') ;
>     print $query->endform;
>     &xit 
109,114c81,84
<     &eval_hidden_struct                                         ;
<     &pr_referer                                                 ;
<  
<     print "<H3>Depth DataBase<HR></H3>"                         ; 
<     print "<H4> Drill Down </H4>"                               ;
<     $db_choice = ${$query -> {db_choice}}[0]                    ;
---
> 
>     print "<H3>Depth DB<HR></H3>"                     ; 
>     print "<H4> Drill Down </H4>"                     ;
>     $db_choice = ${$query -> {db_choice}}[0] ;
116,134c86,116
<     $db = ${$query -> {db}}[0]                                  ;
<     $layer = ${$query -> {layer}}[0]                            ;
<     $depth_str = $query -> param('depth_str')                   ; 
<     $depth_str = "$depth_str $layer"                            ;
<     $depth_str =~ s/^ +//                                       ;
<     @depth_arr = split(/ +/, $depth_str)                        ;
<     @$depth_arr = @depth_arr                                    ;
<     $ob -> db($db)                                              ;
< 
<     #$layer_arr_str = $ob -> layer()                           ; 
<     $layer_arr_str = $ob -> layer(@depth_arr)                  ; 
<     $layer_arr = eval $layer_arr_str                           ; 
<     @$layer_arr = sort @$layer_arr                             ;
< 
<     print $query->
<       startform(-action=>"$script_name/layer",-TARGET=>"depth_ctls");
<     $query -> param('depth_str', $depth_str )                  ;
<     print $query->hidden('depth_str')                          ;
<     print $query->hidden('db', $db )                           ;
---
>     $db = ${$query -> {db}}[0]                        ;
>     $layer = ${$query -> {layer}}[0]                  ;
>     $depth_str = $query -> param('depth_str')         ; 
>     $depth_str = "$depth_str $layer"                  ;
>     $depth_str =~ s/^ +//                             ;
>     @$depth_arr = split(/ +/, $depth_str)             ;
>     $ob -> db($db)                                    ;
> 
>     $layer_arr_str = $ob -> layer(@$depth_arr)        ;  
>     $layer_arr = eval $layer_arr_str                  ;
>     @$layer_arr = sort @$layer_arr                    ;
> 
> print $#$layer_arr,"lay arr\n" ;
> print $#$depth_arr,"dep arr\n" ;
>     if ( $#$layer_arr < 0 and $#$depth_arr < 0) { 
>       print "<H4>No Data</H4>"                        ; 
>       print "<H3>Add First Layer</H4>"                        ; 
>       print $query->startform(-action=>"$script_name/depth",-TARGET=>"depth_canvas");
>       print $query->hidden('depth_str')                    ;
>       print $query->hidden('db', $db )                     ;
>       print "<BR>Password"                                 ;
>       print $query -> password_field(-name=>'secret')      ;
>       print "<BR>".$query->submit(-name => 'New Top Level Data')     ;
>       $hidden_struct -> {db} = $db                         ;
>       $hidden_struct -> {depth_arr} = $depth_arr           ;
>       $hidden_struct_str = $ob -> dump($hidden_struct)     ;
>       $query -> param('hidden_struct', $hidden_struct_str) ;
>       print $query -> hidden('hidden_struct')              ;
>       
>       print $query->endform                                ;
>     }
136c118,124
<     print $query->radio_group(
---
>     else {
> 
>        print $query->startform(-action=>"$script_name/layer",-TARGET=>"depth_ctls");
>        $query -> param('depth_str', $depth_str )         ;
>        print $query->hidden('depth_str')                 ;
>        print $query->hidden('db', $db )                  ;
>        print $query->radio_group(
138c126
<                                -Values    => $layer_arr,
---
>                                -Values    =>  $layer_arr,
141,174c129,152
<     &pr_hidden_struct                                             ;  
<     print " ".$query->submit(-name => 'DRILL DOWN')           ;
<     print $query->endform                                ;
<     $out_depth_str = $depth_str." "                      ;
<     if ( $out_depth_str !~ /^ *$/ ) {
<        $out_depth_str =~ s/ +/-><BR>/g                   ;
<        $out_depth_str = "$out_depth_str <BR>"          ;
<        print "<HR><H4>Data Structures<\H4>"                    ;
<        print $out_depth_str                                 ;
<        print $query->startform(-action=>"$script_name/depth",-TARGET=>"depth_canvas");
<        print $query->hidden('depth_str')                    ;
<        print $query->hidden('db', $db )                     ;
<        print "<BR>Password"                                 ;
<        print $query -> password_field(-name=>'secret')      ;
<        print "<BR>".$query->submit(-name => 'DEPTH')        ; 
<        print $query->endform                                ;
<        $hidden_struct -> {db} = $db                         ; 
<        $hidden_struct -> {depth_arr} = $depth_arr           ;
<        $hidden_struct_str = $ob -> dump($hidden_struct)     ;
<        $query -> param('hidden_struct', $hidden_struct_str) ;
<        print $query->startform(-action=>"$script_name/search",-TARGET=>"depth_canvas");
<        print $query -> hidden('hidden_struct')              ;
<        print "<HR>"                                         ;
<        print " ".$query->submit(-name => 'SEARCH')          ;
<        print $query->endform                                ; 
< 
<        print "<HR>"                                         ;
<        print $query->startform(-action=>"$script_name/new",-TARGET=>"depth_canvas");
<        #print $query->image_button(-name=>'new_button',
<        #                              -src=>'/images/new_button.gif',
<        #                              -align=>'MIDDLE');    
<        print $query -> hidden('hidden_struct')              ;
<        print " ".$query->submit(-name => 'NEW DEPTH OBJECT')          ;
<        print $query->endform                                ;
---
>        print " ".$query->submit(-name => 'DRILL DOWN')         ;
>        print $query->endform                                   ;
>        $out_depth_str = $depth_str." "                         ;
>        if ( $out_depth_str !~ /^ *$/ ) {
>           $out_depth_str =~ s/ +/-><BR>/g                      ;
>           $out_depth_str = "$out_depth_str <BR>"               ;
>           print "<HR><H4>Data Structures<\H4>"                 ;
>           print $out_depth_str                                 ;
>           print $query->startform(-action=>"$script_name/depth",-TARGET=>"depth_canvas");
>           print $query->hidden('depth_str')                    ;
>           print $query->hidden('db', $db )                     ;
>           print "<BR>Password"                                 ;
>           print $query -> password_field(-name=>'secret')      ;
>           print "<BR>".$query->submit(-name => 'DEPTH')        ;       
>           print $query->endform                                ;
>           $hidden_struct -> {db} = $db                         ;       
>           $hidden_struct -> {depth_arr} = $depth_arr           ; 
>           $hidden_struct_str = $ob -> dump($hidden_struct)     ;
>           $query -> param('hidden_struct', $hidden_struct_str) ;
>           print $query->startform(-action=>"$script_name/search",-TARGET=>"depth_canvas");
>           print $query -> hidden('hidden_struct')              ;
>           print " ".$query->submit(-name => 'SEARCH')          ;
>           print $query->endform                                ; 
>        }
176,185c154,169
<     else {
<       $out_depth_str = 'Please Drill Down' ;
<       $hidden_struct -> {db} = $db                         ; 
<       $hidden_struct -> {depth_arr} = $depth_arr           ;
<       $hidden_struct_str = $ob -> dump($hidden_struct)     ;
<       $query -> param('hidden_struct', $hidden_struct_str) ;
<       print $query->startform(-action=>"$script_name/new",-TARGET=>"depth_canvas");
<       print $query -> hidden('hidden_struct')              ;
<       print " ".$query->submit(-name => 'NEW DEPTH OBJECT')          ;
<       print $query->endform   
---
> 
> print $#$depth_arr,"dep arr\n" ;
>     if (  $#$depth_arr < 0 ) {
>     print $query->startform(-action=>"$script_name/depth",-TARGET=>"depth_canvas");
>     print $query->hidden('depth_str')                    ;
>     print $query->hidden('db', $db )                     ;
>     print "<BR>Password"                                 ;
>     print $query -> password_field(-name=>'secret')      ;
>     print "<BR>".$query->submit(-name => 'New Freeze File')     ;
>     $hidden_struct -> {db} = $db                         ;
>     $hidden_struct -> {depth_arr} = $depth_arr           ;
>     $hidden_struct_str = $ob -> dump($hidden_struct)     ;
>     $query -> param('hidden_struct', $hidden_struct_str) ;
>     print $query -> hidden('hidden_struct')              ;
>     print $query->endform                                ;
> 
186a171,172
>  
> 
194a181
>         print " HDN ST" ;
202a190
>         @$depth_arr = split (/ +/, $depth_str )           ;
204,205c192
<       @$depth_arr = split (/ +/, $depth_str )           ;
<       @{$ob -> {'depth_arr'}} = @$depth_arr            ;
---
>       @{$ob -> {'depth_arr'}} = @$depth_arr             ;
210a198,201
>       $out_depth_str = $depth_str                       ;
>       $out_depth_str =~ s/ +/-> /g                      ;
>       print "<H2>$out_depth_str -></H2><BR>"            ;
> 
213a205,206
> 
>       print "</H3>"                                     ;
216,226c209,220
<       $out_depth_str = $depth_str                     ; 
<       $out_depth_str =~ s/ +/-> /g                    ;
<       print "<H3>$out_depth_str -></H3>"              ;
<       $arr_str = $ob -> depth(@$depth_arr)            ;
<       $tmp_arr = eval $arr_str                        ;
<       $ob -> {assc_arr} = $tmp_arr                    ;
<       $ob -> set_header(@$depth_arr)                  ;
<       print $ob -> mk_table                           ;
< #&dump_query ;
< &xit
< }
---
>       $arr_str = $ob -> depth(@$depth_arr)              ;
>       $tmp_arr = eval $arr_str                          ;
>       print  $#$depth_arr,"dep arr" ;
>       if ( $#$depth_arr == -1 and $ob -> {upd} == 'yes') 
>       { 
>       print 
>             "<table><td><FORM METHOD=\"POST\" ACTION=\"/cgi-bin/depth/upd\" ENCTYPE=\"application/x-www-form-urlencoded\" TARGET=\"depth_canvas\"><TEXTAREA NAME=\"upd $db $depth_str \" ROWS=\"4\" ></TEXTAREA>
>              </td><td>
>              <INPUT TYPE=\"submit\" VALUE=\"New top object\" NAME=\"upd_chkbx\" ></FORM>
>              </td></table>
> " ;
>       }
228c222
< sub new_depth_ob {
---
>       if ( $#$depth_arr == 0 and $ob -> {upd} == 'yes') {
230,238c224,231
<    $hidden_struct_str = $query -> param('hidden_struct')  ;
<    $hidden_struct = eval $hidden_struct_str               ;
<    $db = $hidden_struct  -> {db}                          ;
<    @$depth_arr = @{$hidden_struct  -> {depth_arr}}        ;
<    $depth_str = join(' ', @$depth_arr )                   ;
<    print "<H3>"                                           ;
<    print $pr_depth_str = join('->', @$depth_arr ).'->'    ;
<    print "</H3>"                                          ;
<    $ob -> {out_depth_str} = $depth_str                    ;
---
>       $depth_str = $$depth_arr[0] ;
>       print 
>             "<table><td><FORM METHOD=\"POST\" ACTION=\"/cgi-bin/depth/upd\" ENCTYPE=\"application/x-www-form-urlencoded\" TARGET=\"depth_canvas\"><TEXTAREA NAME=\"upd $db $depth_str \" ROWS=\"4\" ></TEXTAREA>
> 
>              </td><td>
>              <INPUT TYPE=\"submit\" VALUE=\"Top Data Layer\" NAME=\"upd_chkbx\" ></FORM>
>              </td></table>"
>       }
240,260d232
<    $hidden_struct_str = $ob -> dump($hidden_struct)       ;
<    $query -> param('hidden_struct', $hidden_struct_str)   ;
<    print $query->startform
<             (-action=>"$script_name/mk_new_ob",-TARGET=>"depth_canvas")  ;
<    print $query -> hidden('hidden_struct')                ;
<    $multi_line =
<             "<FORM METHOD=\"POST\" ENCTYPE=\"application/x-www-form-urlencoded\" TARGET=\"depth_canvas\">"  ;
<    $obj_multi_line = "<TEXTAREA NAME=\"upd_ob\" ROWS=\"5\" ></TEXTAREA>"  ;
<    $val_multi_line = "<TEXTAREA NAME=\"upd_val\" ROWS=\"5\" ></TEXTAREA>" ;
<    print "<h3>"                                           ;
<    print "<HR>Enter Name of New Object<BR>"               ;
<    print $multi_line.$obj_multi_line                      ;
<    print "<HR>Enter Object's Value(optional)<BR>"         ;
<    print $multi_line.$val_multi_line."<BR>" ; # need seperate text area name 
<    print "<HR>Password<BR>"                               ;
<    print $query -> password_field(-name=>'secret')        ;
<    print "</h3>"                                          ;
<    print " ".$query->submit(-name => 'Submit New Data Object')            ;
<    print $query->endform                                  ;
< &xit ;
< }
262,304c234,239
< sub mk_new_ob {
<    &eval_hidden_struct                                    ;
<    @depth_arr = @{$hidden_struct -> {depth_arr}}          ;
<    $new_obj = $query -> param('upd_ob')                   ;
<    @new_obj_arr = split("\n", $new_obj )                  ;
<    foreach $num ( 0..$#new_obj_arr) { 
<       next if $new_obj_arr[$num] =~ /^\s*$/                  ;
<       $new_obj_arr[$num] =~ s/\s+/ /g                     ;
<       $new_obj_arr[$num] =~ s/^\s+//                      ;
<       $new_obj_arr[$num] =~ s/\s+$//                      ;
<       $new_obj_arr[$num] =~ s/ /_/g                       ;
<       push (@upd_obj_arr,  $new_obj_arr[$num]) 
<    }
<    @depth_arr = ( @depth_arr , @upd_obj_arr )             ;
<    $new_val = $query -> param('upd_val')                  ;
<    @new_val_arr = split("\n", $new_val )                  ;
<    foreach $num ( 0..$#new_val_arr) {
<       #print <PRE>$new_val_arr[$num}</PRE>                  ;
<       next if $new_val_arr[$num] =~ /^\s*$/                  ;
<       $new_val_arr[$num] =~ s/\s+/ /g                     ;
<       $new_val_arr[$num] =~ s/\s+$//                      ;
<       push (@upd_val_arr,  $new_val_arr[$num]) 
<    }
<    if ( $#upd_val_arr > -1 ) {
<      $upd_val = $ob -> arr2str(@upd_val_arr)              ;
<    }
<    else { $upd_val = 'undef' } 
<    if (
<       ($query->param('secret') eq 'password')
<         and 
<       ( ! $new_obj =~ /^(\s|)+$/)
<       ) {
<       $db = $hidden_struct -> {db}                        ;
<       $ob -> db($db)                                      ;
<       $out =  $ob -> upd(@depth_arr, $upd_val)            ;
<       print $out 
<    }
<    else { print "<H3>Enter Password</H3>" }              
<    $hidden_struct -> {db} = $db                           ;
<    @{$hidden_struct -> {depth_arr}} = @depth_arr          ;
<    &pr_hidden_struct                                      ;
<    &depth                                                 ;    
<    &xit 
---
>       $ob -> {assc_arr} = $tmp_arr                    ;
>       $ob -> set_header(@$depth_arr)                  ;
>       print $ob -> mk_table                           ;
> 
> &dump_query ;
> &xit
307a243,244
> 
>    print $query -> param('hidden_struct')                 ;
309,312c246,248
<    $upd_val_str = $query -> param($upd_cmd)               ;
<    print $upd_val_str,"upd val str<BR>"                   ;
<    $upd_val_str =~ s/\'//g                                ;
<    @$upd_val = split("\n", $upd_val_str)                  ;
---
>    $upd_val = $query -> param($upd_cmd)                   ;
> 
>    @$upd_val = split("\n", $upd_val)                      ;
316c252,285
<    $upd_val = $ob -> arr2str(@$upd_val)                   ;
---
>    #print "<PRE>",$upd_val," </PRE> upd val"                ;
>  
>    if ( @{$query -> {upd_chkbx}}[0] eq 'new_ob' ) 
>      { push @depth_arr, $upd_val                          ;
>        $upd_val = undef                                   ;
>      }
> 
>    elsif ( @{$query -> {upd_chkbx}}[0] eq 'new_last_ob' ) 
>      { 
>        pop @depth_arr                                     ;
>        push @depth_arr, $upd_val                          ;
>        $upd_val = undef                                   ;
>      }
> 
>    elsif ( @{$query -> {upd_chkbx}}[0] eq 'new_ext_last_ob' )
>      { 
>        push @depth_arr, $upd_val                          ;
>        $upd_val = undef                                   ;
>      }
>    elsif ( @{$query -> {upd_chkbx}}[0] eq 'New top object' )
>      {
>        push @depth_arr, $upd_val                          ;
>        $upd_val = undef                                   ;
>      }
>    elsif ( @{$query -> {upd_chkbx}}[0] eq 'Top Data Layer' )
>      {
>        push @depth_arr, $upd_val                          ;
>        $upd_val = undef                                   ;
>      }
>  
> 
>    #$upd_val = $ob -> arr2str(@$upd_val)                   ;
>    print "<PRE> $upd_val </PRE>"                          ;
>    #print " -$upd_val- xxx upd val pre"                          ;
318,340c287,294
<    $ob -> db($db)                                         ;
<    if (( $query -> param(upd_chkbx) eq 'new_ob' ) or 
<        ( $query -> param(upd_chkbx) eq 'new_ext_last_ob' )) {
<     #$out =  $ob -> del(@depth_arr)                        ;
<     $upd_val_str =~ s/\s/_/g                               ;
<     print "<BR>".$upd_val_str." upd val str <BR>"          ;
<     push (@depth_arr, $upd_val_str)                       ;
<     push (@depth_arr, 'undef')                            ;
<     print "<BR>dep arr+".join ('-', @depth_arr)."+<BR>"     ; 
<     @upd_arr = @depth_arr                                 ; 
<    }  ;
<    if (( $query -> param(upd_chkbx) eq 'new_last_ob' ) or
<        ( $query -> param(upd_chkbx) eq 'new_extend_ob' )) {
<     #$out =  $ob -> del(@depth_arr)                        ;
<     $upd_val_str =~ s/\s/_/g                               ;
<     print $upd_val_str,"upd val str"                      ;
<     pop @depth_arr                                        ;
<     push (@depth_arr, $upd_val_str)                       ;
<     print join ('-', @depth_arr)."<BR>"                   ;
<     push (@depth_arr, 'undef')                            ;
<     @upd_arr = @depth_arr                                 ;
<    }  ;
<    print $out =  $ob -> upd(@upd_arr)                     ;
---
>    print $ob -> db($db)                                         ;
>    print "<pre>====",join ('--', @upd_arr), "====join\n</pre>" ;
>    $ob -> write ;
>    print $ob -> upd(@upd_arr)                           ;
>    pop @upd_arr                                           ;
>    #print "<pre> xxx ";
>    #print $ob -> depth(@upd_arr)                           ;
>    #print "xxx </pre>" ;
345,346c299
<    print $query -> hidden('hidden_struct')                ;
< &dump_query;
---
>    #print $query -> hidden('hidden_struct')                ;
347a301
> 
355c309
<    pop  @depth_arr                                        ;
---
>    pop @depth_arr                                         ;
357,358c311,319
<    my @del_arr = @depth_arr                               ;
<    print $ob -> db($db)                                   ;
---
>    print "<PRE>",$del_val,"</PRE> del val"               ;
> 
>    #$del_val = $ob -> arr2str(@$del_val)                  ;
>    #print "<PRE> $del_val </PRE>"                         ;
>    #print $del_val," del val pre"                         ;
>    #@upd_arr = ( @depth_arr, $del_val )                   ;
>    @del_arr = ( @depth_arr )                    ;
>    $ob -> db($db)                                         ;
>    $ob -> write                                           ;
360d320
<    print "<PRE>$out</PRE>"                                ;
365c325
<    print $query -> hidden('hidden_struct')                ;
---
>    #print $query -> hidden('hidden_struct')                ;
366a327
> 
368a330,331
> 
> 
370c333
<   
---
> 
385d347
<    print "<H3>$pr_depth_str</H3>"                         ;
386a349
>    print "<H3>$pr_depth_str</H3>"                         ;
388c351
<      $arr_str =  $query->textfield("arr_str.$num")        ;   
---
>      $arr_str =  $query->textfield("arr_str.$num")       ;   
393,411c356,357
<    print " ".$query->submit(-name => 'Multi SEARCH DEPTH') ;
<    print $query -> hidden('hidden_struct')                ;
<    print $query->endform                                  ;
< 
<    print "<HR>"                                           ;
<    print $query->startform(-action=>"$script_name/search_depth",-TARGET=>"depth_canvas");
<    print "<table border=5 bgcolor=\"#FFFF80\"><tr><td></tr></td><tr><td>"                                ;
< #   print $query->textfield(-name => "arr_str.singl",
< #                           -size => 50    
< #                          )                               ;   
< 
<    print $query->textarea(-name=>'arr_str.singl',
<                                -rows=>3,
<                                -columns=>50);
< 
<    print "</tr></td></table>"                             ;
<    print " ".$query->submit(-name => 'Single SEARCH DEPTH') ;
<    print $query -> hidden('hidden_struct')                ;
<    &pr_hidden_struct                                     ;
---
>    print " ".$query->submit(-name => 'SEARCH DEPTH' )      ;
>    print $query -> hidden('hidden_struct')              ;
428,435c374,375
<    if ( $query -> param('arr_str.singl') ne '' ) {
<      push @$search_arr,$query -> param('arr_str.singl')   ; 
<      $ob -> {single_search_str} = $query -> param('arr_str.singl')   ;
<    }
<    else {
<      foreach $num ( 0..$arr_num +1 ) {
<        push @$search_arr, ${$query ->{"arr_str.$num"}}[0]
<      }
---
>    foreach $num (0..$arr_num +1 ) {
>     push @$search_arr, ${$query ->{"arr_str.$num"}}[0]    ;
441,442c381,395
<    if ( $query -> param('arr_str.singl') ne '' ) {
<      $ob -> single_search(@$search_arr)                   ;
---
>    $ob -> search(@$search_arr)                            ;
> 
> &dump_query ;
> &xit ;
> }                    
> 
> sub new_fz {
> 
> print "hello\n" ;
>    $hidden_struct_str = $query -> param('hidden_struct') ;
>    if ( $hidden_struct_str ne '' ) {
>       $hidden_struct = eval $hidden_struct_str           ;
>       $db = $hidden_struct  -> {db}                      ;
>       @$depth_arr = @{$hidden_struct  -> {depth_arr}}    ;
>       $depth_str = join(' ', @$depth_arr )               ;
445c398,399
<      $ob -> search(@$search_arr)                          ;
---
>       $db = $query->param('db')                          ;
>       $depth_str = $query -> param('depth_str')          ;
447d400
< #&dump_query ;
449c402,403
< }                    
---
> 
> }
468,469c422,423
<     <img  src=/images/cxn_fancy.gif height=\"200\" 
<                               align=\"absmiddle\" width=\"300\">
---
>     <img  src=/images/sun_earth.gif height=\"250\" 
>                               align=\"absmiddle\" width=\"450\">
475d428
< print $query->end_html;
476a430
> print $query->end_html;
477a432
> exit ;
